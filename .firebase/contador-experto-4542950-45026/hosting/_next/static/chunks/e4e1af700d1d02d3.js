(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(75157);let s=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));s.displayName="Card";let o=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));o.displayName="CardHeader";let l=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let n=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));n.displayName="CardDescription";let d=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent";let i=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t}));i.displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>d,"CardDescription",()=>n,"CardFooter",()=>i,"CardHeader",()=>o,"CardTitle",()=>l])},84774,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(75157);let s=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:s,className:(0,a.cn)("w-full caption-bottom text-sm",e),...t})}));s.displayName="Table";let o=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("thead",{ref:s,className:(0,a.cn)("[&_tr]:border-b",e),...t}));o.displayName="TableHeader";let l=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("tbody",{ref:s,className:(0,a.cn)("[&_tr:last-child]:border-0",e),...t}));l.displayName="TableBody";let n=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("tfoot",{ref:s,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));n.displayName="TableFooter";let d=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("tr",{ref:s,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));d.displayName="TableRow";let i=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("th",{ref:s,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));i.displayName="TableHead";let c=t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("td",{ref:s,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));c.displayName="TableCell",t.forwardRef(({className:e,...t},s)=>(0,r.jsx)("caption",{ref:s,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption",e.s(["Table",()=>s,"TableBody",()=>l,"TableCell",()=>c,"TableFooter",()=>n,"TableHead",()=>i,"TableHeader",()=>o,"TableRow",()=>d])},87486,e=>{"use strict";var r=e.i(43476),t=e.i(25913),a=e.i(75157);let s=(0,t.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:t,...o}){return(0,r.jsx)("div",{className:(0,a.cn)(s({variant:t}),e),...o})}e.s(["Badge",()=>o])},65830,e=>{"use strict";var r=e.i(43476),t=e.i(52990),a=e.i(82830),s=e.i(84774);function o({columns:e,data:o,meta:l}){let n=(0,t.useReactTable)({data:o,columns:e,getCoreRowModel:(0,a.getCoreRowModel)(),meta:l});return(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(s.Table,{children:[(0,r.jsx)(s.TableHeader,{children:n.getHeaderGroups().map(e=>(0,r.jsx)(s.TableRow,{children:e.headers.map(e=>(0,r.jsx)(s.TableHead,{children:e.isPlaceholder?null:(0,t.flexRender)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,r.jsx)(s.TableBody,{children:n.getRowModel().rows?.length?n.getRowModel().rows.map(e=>(0,r.jsx)(s.TableRow,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,r.jsx)(s.TableCell,{children:(0,t.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,r.jsx)(s.TableRow,{children:(0,r.jsx)(s.TableCell,{colSpan:e.length,className:"h-24 text-center",children:"No results."})})})]})})}e.s(["DataTable",()=>o])},95187,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={callServer:function(){return o.callServer},createServerReference:function(){return n.createServerReference},findSourceMapURL:function(){return l.findSourceMapURL}};for(var s in a)Object.defineProperty(t,s,{enumerable:!0,get:a[s]});let o=e.r(32120),l=e.r(92245),n=e.r(35326)},16e3,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(19455),s=e.i(15288),o=e.i(55764),l=e.i(65830),n=e.i(87486);let d=[{accessorKey:"date",header:"Fecha"},{accessorKey:"documentNumber",header:"N° Boleta"},{accessorKey:"issuerName",header:"Emisor"},{accessorKey:"issuerRut",header:"RUT Emisor"},{accessorKey:"grossAmount",header:()=>(0,r.jsx)("div",{className:"text-right",children:"Monto Bruto"}),cell:({row:e})=>{let t=parseFloat(e.getValue("grossAmount")),a=new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(t);return(0,r.jsx)("div",{className:"text-right font-medium",children:a})}},{accessorKey:"retentionAmount",header:()=>(0,r.jsx)("div",{className:"text-right",children:"Monto Retenido"}),cell:({row:e})=>{let t=parseFloat(e.getValue("retentionAmount")),a=new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(t);return(0,r.jsx)("div",{className:"text-right font-medium",children:a})}},{accessorKey:"netAmount",header:()=>(0,r.jsx)("div",{className:"text-right",children:"Monto Líquido"}),cell:({row:e})=>{let t=parseFloat(e.getValue("netAmount")),a=new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(t);return(0,r.jsx)("div",{className:"text-right font-medium",children:a})}},{accessorKey:"status",header:"Estado",cell:({row:e})=>{let t=e.getValue("status");return(0,r.jsx)(n.Badge,{variant:"NULA"===t?"destructive":"default",children:t})}}];var i=e.i(8406),c=e.i(95187),u=(0,c.createServerReference)("40be944e18140488ff06db298517f2a17f1e04902f",c.callServer,void 0,c.findSourceMapURL,"centralizeFees"),f=e.i(18566),m=e.i(39126),x=e.i(86135);function h(){let{toast:e}=(0,i.useToast)(),n=(0,f.useRouter)(),c=t.default.useContext(m.SelectedCompanyContext),[h,p]=t.default.useState([]),[b,v]=t.default.useState(!1),g=t.default.useRef(null),y=async t=>{let s=t.target.files?.[0];if(!s)return void e({title:"No se seleccionó ningún archivo.",variant:"destructive"});let o=c?.selectedCompany;if(!o)return void e({title:"Error",description:"No hay una empresa seleccionada.",variant:"destructive"});if(!o.feesExpenseAccount||!o.feesWithholdingAccount||!o.feesPayableAccount)return void e({title:"Error de Configuración",description:"Las cuentas de honorarios no están configuradas en la empresa.",variant:"destructive"});let l=o.periodStartDate?(0,x.parseISO)(o.periodStartDate):new Date,d={month:l.getMonth()+1,year:l.getFullYear()};v(!0),e({title:"Procesando archivo...",description:"Esto puede tardar unos segundos."});try{let t={fileContent:await new Promise((e,r)=>{let t=new FileReader;t.readAsDataURL(s),t.onload=()=>e(t.result.split(",")[1]),t.onerror=e=>r(e)}),companyConfig:{id:o.id,feesExpenseAccount:o.feesExpenseAccount,feesWithholdingAccount:o.feesWithholdingAccount,feesPayableAccount:o.feesPayableAccount},accountingPeriod:d},{summary:l,processedHonorarios:i}=await u(t);p(e=>[...i,...e]),e({title:"Proceso Completado Exitosamente",description:`Se procesaron ${l.totalProcessed} boletas. ${l.totalValid} v\xe1lidas y ${l.totalInvalid} inv\xe1lidas. Comprobante creado.`,variant:"success",action:(0,r.jsx)(a.Button,{onClick:()=>n.push(`/dashboard/vouchers/${l.voucherId}`),children:"Revisar"})})}catch(r){console.error("Error during fee centralization:",r),e({title:"Ocurrió un error",description:r.message||"No se pudo procesar el archivo.",variant:"destructive"})}finally{v(!1),g.current&&(g.current.value="")}};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Honorarios Recibidos"}),(0,r.jsxs)(s.Card,{children:[(0,r.jsxs)(s.CardHeader,{children:[(0,r.jsx)(s.CardTitle,{children:"Importar y Centralizar REC"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sube el Registro de Honorarios (REC) del SII para importar las boletas y generar automáticamente el comprobante de centralización."})]}),(0,r.jsx)(s.CardContent,{children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[(0,r.jsx)(o.Input,{type:"file",ref:g,onChange:y,accept:".csv,.xls",className:"max-w-xs hidden",id:"file-upload",disabled:b}),(0,r.jsx)(a.Button,{asChild:!0,children:(0,r.jsx)("label",{htmlFor:"file-upload",className:`cursor-pointer ${b?"opacity-50":""}`,children:b?"Procesando...":"Seleccionar Archivo"})}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Archivos soportados: .csv, .xls (del SII)"})]})})]}),(0,r.jsxs)(s.Card,{children:[(0,r.jsx)(s.CardHeader,{children:(0,r.jsx)(s.CardTitle,{children:"Boletas de Honorarios Importadas"})}),(0,r.jsx)(s.CardContent,{children:(0,r.jsx)(l.DataTable,{columns:d,data:h})})]})]})}e.s(["default",()=>h],16e3)}]);
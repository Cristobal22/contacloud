(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6555,e=>{"use strict";var a=e.i(43476),l=e.i(71645),n=e.i(15288),i=e.i(68499),s=e.i(76639),t=e.i(19455),o=e.i(55764),r=e.i(10204);e.i(11981);var c=e.i(80428),d=e.i(41899),u=e.i(61480),h=e.i(39126);e.i(36180);var m=e.i(17875),x=e.i(18566),g=e.i(71689),j=e.i(31278),p=e.i(27612),C=e.i(22016);let v=["Afgana","Alemana","Argentina","Australiana","Belga","Boliviana","Brasileña","Canadiense","Chilena","China","Colombiana","Coreana","Costarricense","Cubana","Danesa","Dominicana","Ecuatoriana","Egipcia","Española","Estadounidense","Filipina","Francesa","Griega","Guatemalteca","Haitiana","Holandesa","Hondureña","India","Inglesa","Iraní","Iraquí","Irlandesa","Israelí","Italiana","Japonesa","Mexicana","Nicaragüense","Nigeriana","Noruega","Panameña","Paraguaya","Peruana","Polaca","Portuguesa","Puertorriqueña","Rusa","Salvadoreña","Sueca","Suiza","Tailandesa","Turca","Uruguaya","Venezolana","Otra"],b=["Arica y Parinacota","Tarapacá","Antofagasta","Atacama","Coquimbo","Valparaíso","Metropolitana de Santiago","Libertador General Bernardo O'Higgins","Maule","Ñuble","Biobío","La Araucanía","Los Ríos","Los Lagos","Aysén del General Carlos Ibáñez del Campo","Magallanes y de la Antártica Chilena"],S={"Arica y Parinacota":["Arica","Camarones","Putre","General Lagos"],Tarapacá:["Iquique","Alto Hospicio","Pozo Almonte","Camiña","Colchane","Huara","Pica"],Antofagasta:["Antofagasta","Mejillones","Sierra Gorda","Taltal","Calama","Ollagüe","San Pedro de Atacama","Tocopilla","María Elena"],Atacama:["Copiapó","Caldera","Tierra Amarilla","Chañaral","Diego de Almagro","Vallenar","Alto del Carmen","Freirina","Huasco"],Coquimbo:["La Serena","Coquimbo","Andacollo","La Higuera","Paiguano","Vicuña","Illapel","Canela","Los Vilos","Salamanca","Ovalle","Combarbalá","Monte Patria","Punitaqui","Río Hurtado"],Valparaíso:["Valparaíso","Casablanca","Concón","Juan Fernández","Puchuncaví","Quintero","Viña del Mar","Isla de Pascua","Los Andes","Calle Larga","Rinconada","San Esteban","La Ligua","Cabildo","Papudo","Petorca","Zapallar","Quillota","Calera","Hijuelas","La Cruz","Nogales","San Antonio","Algarrobo","Cartagena","El Quisco","El Tabo","Santo Domingo","San Felipe","Catemu","Llaillay","Panquehue","Putaendo","Santa María","Quilpué","Limache","Olmué","Villa Alemana"],"Metropolitana de Santiago":["Santiago","Cerrillos","Cerro Navia","Conchalí","El Bosque","Estación Central","Huechuraba","Independencia","La Cisterna","La Florida","La Granja","La Pintana","La Reina","Las Condes","Lo Barnechea","Lo Espejo","Lo Prado","Macul","Maipú","Ñuñoa","Pedro Aguirre Cerda","Peñalolén","Providencia","Pudahuel","Quilicura","Quinta Normal","Recoleta","Renca","San Joaquín","San Miguel","San Ramón","Vitacura","Puente Alto","Pirque","San José de Maipo","Colina","Lampa","Tiltil","San Bernardo","Buin","Calera de Tango","Paine","Melipilla","Alhué","Curacaví","María Pinto","San Pedro","Talagante","El Monte","Isla de Maipo","Padre Hurtado","Peñaflor"],"Libertador General Bernardo O'Higgins":["Rancagua","Codegua","Coinco","Coltauco","Doñihue","Graneros","Las Cabras","Machalí","Malloa","Mostazal","Olivar","Peumo","Pichidegua","Quinta de Tilcoco","Rengo","Requínoa","San Vicente","Pichilemu","La Estrella","Litueche","Marchihue","Navidad","Paredones","San Fernando","Chépica","Chimbarongo","Lolol","Nancagua","Palmilla","Peralillo","Placilla","Pumanque","Santa Cruz"],Maule:["Talca","Constitución","Curepto","Empedrado","Maule","Pelarco","Pencahue","Río Claro","San Clemente","San Rafael","Cauquenes","Chanco","Pelluhue","Curicó","Hualañé","Licantén","Molina","Rauco","Romeral","Sagrada Familia","Teno","Vichuquén","Linares","Colbún","Longaví","Parral","Retiro","San Javier","Villa Alegre","Yerbas Buenas"],Ñuble:["Chillán","Bulnes","Chillán Viejo","El Carmen","Pemuco","Pinto","Quillón","San Ignacio","Yungay","Quirihue","Cobquecura","Coelemu","Ninhue","Portezuelo","Ránquil","Treguaco","San Carlos","Coihueco","Ñiquén","San Fabián","San Nicolás"],Biobío:["Concepción","Coronel","Chiguayante","Florida","Hualqui","Lota","Penco","San Pedro de la Paz","Santa Juana","Talcahuano","Tomé","Hualpén","Lebu","Arauco","Cañete","Contulmo","Curanilahue","Los Álamos","Tirúa","Los Ángeles","Antuco","Cabrero","Laja","Mulchén","Nacimiento","Negrete","Quilaco","Quilleco","San Rosendo","Santa Bárbara","Tucapel","Yumbel","Alto Biobío"],"La Araucanía":["Temuco","Carahue","Cunco","Curarrehue","Freire","Galvarino","Gorbea","Lautaro","Loncoche","Melipeuco","Nueva Imperial","Padre las Casas","Perquenco","Pitrufquén","Pucón","Saavedra","Teodoro Schmidt","Toltén","Vilcún","Villarrica","Cholchol","Angol","Collipulli","Curacautín","Ercilla","Lonquimay","Los Sauces","Lumaco","Purén","Renaico","Traiguén","Victoria"],"Los Ríos":["Valdivia","Corral","Lanco","Los Lagos","Máfil","Mariquina","Paillaco","Panguipulli","La Unión","Futrono","Lago Ranco","Río Bueno"],"Los Lagos":["Puerto Montt","Calbuco","Cochamó","Fresia","Frutillar","Los Muermos","Llanquihue","Maullín","Puerto Varas","Castro","Ancud","Chonchi","Curaco de Vélez","Dalcahue","Puqueldón","Queilén","Quellón","Quemchi","Quinchao","Osorno","Puerto Octay","Purranque","Puyehue","Río Negro","San Juan de la Costa","San Pablo","Chaitén","Futaleufú","Hualaihué","Palena"],"Aysén del General Carlos Ibáñez del Campo":["Coyhaique","Lago Verde","Aysén","Cisnes","Guaitecas","Cochrane","O'Higgins","Tortel","Chile Chico","Río Ibáñez"],"Magallanes y de la Antártica Chilena":["Punta Arenas","Laguna Blanca","Río Verde","San Gregorio","Cabo de Hornos (Ex Navarino)","Antártica","Porvenir","Primavera","Timaukel","Natales","Torres del Paine"]};var y=e.i(95187),N=(0,y.createServerReference)("6029ebe197f73676e1b8b62c32435050154aa9e639",y.callServer,void 0,y.findSourceMapURL,"checkEmployeeHistory"),f=(0,y.createServerReference)("6004dc7c5589f948e895418bdb8814d7e8525b699d",y.callServer,void 0,y.findSourceMapURL,"softDeleteEmployee"),L=(0,y.createServerReference)("60bbd836a5793b8b35271d9e12ab6fd7dee5e2b5ce",y.callServer,void 0,y.findSourceMapURL,"permanentlyDeleteEmployee"),I=e.i(8406),A=e.i(67489);function P({employee:e,handleFieldChange:l,availableCommunes:n}){return(0,a.jsxs)("section",{id:"personal-data",className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"1. Datos Personales"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"RUT"}),(0,a.jsx)(o.Input,{value:e.rut,onChange:e=>l("rut",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Nombres"}),(0,a.jsx)(o.Input,{value:e.firstName,onChange:e=>l("firstName",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Apellidos"}),(0,a.jsx)(o.Input,{value:e.lastName,onChange:e=>l("lastName",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Fecha de Nacimiento"}),(0,a.jsx)(o.Input,{type:"date",value:e.birthDate,onChange:e=>l("birthDate",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Nacionalidad"}),(0,a.jsxs)(A.Select,{value:e.nationality,onValueChange:e=>l("nationality",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"Selecciona..."})}),(0,a.jsx)(A.SelectContent,{children:v.map(e=>(0,a.jsx)(A.SelectItem,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Dirección"}),(0,a.jsx)(o.Input,{value:e.address,onChange:e=>l("address",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Región"}),(0,a.jsxs)(A.Select,{value:e.region,onValueChange:e=>l("region",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"Selecciona..."})}),(0,a.jsx)(A.SelectContent,{children:b.map(e=>(0,a.jsx)(A.SelectItem,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Comuna"}),(0,a.jsxs)(A.Select,{value:e.commune,onValueChange:e=>l("commune",e),disabled:!e.region,children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"Selecciona..."})}),(0,a.jsx)(A.SelectContent,{children:n.map(e=>(0,a.jsx)(A.SelectItem,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Teléfono"}),(0,a.jsx)(o.Input,{value:e.phone,onChange:e=>l("phone",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Email"}),(0,a.jsx)(o.Input,{type:"email",value:e.email,onChange:e=>l("email",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Género"}),(0,a.jsxs)(A.Select,{value:e.gender,onValueChange:e=>l("gender",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"Selecciona..."})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Masculino",children:"Masculino"}),(0,a.jsx)(A.SelectItem,{value:"Femenino",children:"Femenino"}),(0,a.jsx)(A.SelectItem,{value:"Otro",children:"Otro"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Estado Civil"}),(0,a.jsxs)(A.Select,{value:e.maritalStatus,onValueChange:e=>l("maritalStatus",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"Selecciona..."})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Soltero(a)",children:"Soltero(a)"}),(0,a.jsx)(A.SelectItem,{value:"Casado(a)",children:"Casado(a)"}),(0,a.jsx)(A.SelectItem,{value:"Viudo(a)",children:"Viudo(a)"}),(0,a.jsx)(A.SelectItem,{value:"Divorciado(a)",children:"Divorciado(a)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Nombre Contacto Emergencia"}),(0,a.jsx)(o.Input,{value:e.emergencyContactName,onChange:e=>l("emergencyContactName",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Teléfono Contacto Emergencia"}),(0,a.jsx)(o.Input,{value:e.emergencyContactPhone,onChange:e=>l("emergencyContactPhone",e.target.value)})]})]})]})}function T({employee:e,handleFieldChange:l,costCenters:n}){return(0,a.jsxs)("section",{id:"contract-data",className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"2. Datos Contractuales y de Remuneración"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Cargo"}),(0,a.jsx)(o.Input,{value:e.position,onChange:e=>l("position",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Tipo Contrato"}),(0,a.jsxs)(A.Select,{value:e.contractType,onValueChange:e=>l("contractType",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"..."})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Indefinido",children:"Indefinido"}),(0,a.jsx)(A.SelectItem,{value:"Plazo Fijo",children:"Plazo Fijo"}),(0,a.jsx)(A.SelectItem,{value:"Por Obra o Faena",children:"Por Obra o Faena"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Fecha Inicio"}),(0,a.jsx)(o.Input,{type:"date",value:e.contractStartDate,onChange:e=>l("contractStartDate",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Fecha Término"}),(0,a.jsx)(o.Input,{type:"date",value:e.contractEndDate,onChange:e=>l("contractEndDate",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Horas Semanales"}),(0,a.jsx)(o.Input,{type:"number",value:e.weeklyHours,onChange:e=>l("weeklyHours",parseFloat(e.target.value)||0)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Jornada"}),(0,a.jsxs)(A.Select,{value:e.workday,onValueChange:e=>l("workday",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Completa",children:"Completa"}),(0,a.jsx)(A.SelectItem,{value:"Parcial",children:"Parcial"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Centro de Costo"}),(0,a.jsxs)(A.Select,{value:e.costCenterId,onValueChange:e=>l("costCenterId",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"..."})}),(0,a.jsx)(A.SelectContent,{children:n?.map(e=>(0,a.jsx)(A.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Estado"}),(0,a.jsxs)(A.Select,{value:e.status,onValueChange:e=>l("status",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Active",children:"Activo"}),(0,a.jsx)(A.SelectItem,{value:"Inactive",children:"Inactivo"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Sueldo Base"}),(0,a.jsx)(o.Input,{type:"number",value:e.baseSalary,onChange:e=>l("baseSalary",parseFloat(e.target.value)||0)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Movilización"}),(0,a.jsx)(o.Input,{type:"number",value:e.mobilization,onChange:e=>l("mobilization",parseFloat(e.target.value)||0)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Colación"}),(0,a.jsx)(o.Input,{type:"number",value:e.collation,onChange:e=>l("collation",parseFloat(e.target.value)||0)})]})]})]})}var D=e.i(84774),F=e.i(86536),V=e.i(74323);function M({employee:e,handleFieldChange:l,setBonoDialogState:i}){return(0,a.jsxs)("section",{id:"fixed-bonuses",className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"3. Bonos Fijos Imponibles"}),(0,a.jsxs)(n.Card,{className:"border-dashed",children:[(0,a.jsx)(n.CardContent,{className:"pt-6",children:0===(e.bonosFijos||[]).length?(0,a.jsx)("p",{className:"text-center text-sm text-muted-foreground",children:"No hay bonos fijos."}):(0,a.jsxs)(D.Table,{children:[(0,a.jsx)(D.TableHeader,{children:(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableHead,{children:"Glosa"}),(0,a.jsx)(D.TableHead,{className:"text-right",children:"Monto"}),(0,a.jsx)(D.TableHead,{className:"w-[100px] text-right",children:"Acciones"})]})}),(0,a.jsx)(D.TableBody,{children:e.bonosFijos?.map((n,s)=>{let o;return(0,a.jsxs)(D.TableRow,{children:[(0,a.jsx)(D.TableCell,{children:n.glosa}),(0,a.jsx)(D.TableCell,{className:"text-right",children:(o=n.monto,new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(Math.round(o)))}),(0,a.jsxs)(D.TableCell,{className:"text-right",children:[(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",onClick:()=>i({isOpen:!0,bono:n,index:s}),children:(0,a.jsx)(F.Eye,{className:"h-4 w-4"})}),(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",onClick:()=>l("bonosFijos",(e.bonosFijos||[]).filter((e,a)=>a!==s)),children:(0,a.jsx)(p.Trash2,{className:"h-4 w-4 text-destructive"})})]})]},s)})})]})}),(0,a.jsx)(n.CardFooter,{children:(0,a.jsxs)(t.Button,{variant:"outline",onClick:()=>i({isOpen:!0,bono:{glosa:"",monto:0},index:null}),children:[(0,a.jsx)(V.PlusCircle,{className:"mr-2 h-4 w-4"})," Agregar Bono"]})})]})]})}function E({employee:e,handleFieldChange:l}){return(0,a.jsxs)("section",{id:"gratification",className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"4. Gratificación Legal"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Tipo"}),(0,a.jsxs)(A.Select,{value:e.gratificationType,onValueChange:e=>l("gratificationType",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Sin Gratificación",children:"Sin Gratificación"}),(0,a.jsx)(A.SelectItem,{value:"Tope Legal",children:"Tope Legal"}),(0,a.jsx)(A.SelectItem,{value:"Automatico",children:"Automático (25%)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Monto Calculado"}),(0,a.jsx)(o.Input,{type:"number",value:e.gratification,disabled:!0})]})]})]})}var R=e.i(57428);function B({employee:e,handleFieldChange:l,uniqueAfpEntities:n,uniqueHealthEntities:i}){return(0,a.jsxs)("section",{id:"previsional-data",className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"5. Datos Previsionales"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[(0,a.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,a.jsx)(r.Label,{children:"Sistema de Salud"}),(0,a.jsxs)(A.Select,{value:e.healthSystem,onValueChange:e=>l("healthSystem",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"..."})}),(0,a.jsx)(A.SelectContent,{children:i.map(e=>(0,a.jsx)(A.SelectItem,{value:e.name,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Tipo Cotización"}),(0,a.jsxs)(A.Select,{value:e.healthContributionType,onValueChange:e=>l("healthContributionType",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Porcentaje",children:"%"}),(0,a.jsx)(A.SelectItem,{value:"Monto Fijo",children:"UF"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Valor Cotización"}),(0,a.jsx)(o.Input,{type:"number",value:e.healthContributionValue,onChange:e=>l("healthContributionValue",parseFloat(e.target.value)||0)})]}),(0,a.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,a.jsx)(r.Label,{children:"AFP"}),(0,a.jsxs)(A.Select,{value:e.afp,onValueChange:e=>l("afp",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"..."})}),(0,a.jsx)(A.SelectContent,{children:n.map(e=>(0,a.jsx)(A.SelectItem,{value:e.name,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Tipo Contrato (Seg. Cesantía)"}),(0,a.jsxs)(A.Select,{value:e.unemploymentInsuranceType,onValueChange:e=>l("unemploymentInsuranceType",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"..."})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Indefinido",children:"Indefinido"}),(0,a.jsx)(A.SelectItem,{value:"Plazo Fijo",children:"Plazo Fijo"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 pt-6",children:[(0,a.jsx)(R.Checkbox,{id:"hasUnemploymentInsurance",checked:e.hasUnemploymentInsurance,onCheckedChange:e=>l("hasUnemploymentInsurance",e)}),(0,a.jsx)(r.Label,{htmlFor:"hasUnemploymentInsurance",children:"Acogido a Seguro de Cesantía"})]})]})]})}function w({employee:e,handleFieldChange:l}){return(0,a.jsxs)("section",{id:"family-allowance",className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"6. Asignación Familiar"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(R.Checkbox,{id:"hasFamilyAllowance",checked:e.hasFamilyAllowance,onCheckedChange:e=>l("hasFamilyAllowance",e)}),(0,a.jsx)(r.Label,{htmlFor:"hasFamilyAllowance",children:"Aplica Asignación Familiar"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Cargas"}),(0,a.jsx)(o.Input,{type:"number",value:e.familyDependents,onChange:e=>l("familyDependents",parseInt(e.target.value)||0),disabled:!e.hasFamilyAllowance})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Tramo"}),(0,a.jsxs)(A.Select,{value:e.familyAllowanceBracket,onValueChange:e=>l("familyAllowanceBracket",e),disabled:!e.hasFamilyAllowance,children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"..."})}),(0,a.jsx)(A.SelectContent,{children:["A","B","C","D"].map(e=>(0,a.jsxs)(A.SelectItem,{value:e,children:["Tramo ",e]},e))})]})]})]})]})}function H({employee:e,handleFieldChange:l}){return(0,a.jsxs)("section",{id:"apv-data",className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium border-b pb-2",children:"7. Ahorro Previsional Voluntario (APV)"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Institución"}),(0,a.jsx)(o.Input,{value:e.apvInstitution,onChange:e=>l("apvInstitution",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Monto"}),(0,a.jsx)(o.Input,{type:"number",value:e.apvAmount,onChange:e=>l("apvAmount",parseFloat(e.target.value)||0)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Regimen APV"}),(0,a.jsxs)(A.Select,{value:e.apvRegime,onValueChange:e=>l("apvRegime",e),children:[(0,a.jsx)(A.SelectTrigger,{children:(0,a.jsx)(A.SelectValue,{placeholder:"..."})}),(0,a.jsxs)(A.SelectContent,{children:[(0,a.jsx)(A.SelectItem,{value:"Regimen A",children:"Regimen A"}),(0,a.jsx)(A.SelectItem,{value:"Regimen B",children:"Regimen B"})]})]})]})]})]})}let q={rut:"",firstName:"",lastName:"",birthDate:"",nationality:"",address:"",region:"",commune:"",phone:"",email:"",gender:void 0,maritalStatus:void 0,emergencyContactName:"",emergencyContactPhone:"",position:"",contractType:void 0,contractStartDate:"",contractEndDate:"",weeklyHours:45,workday:"Completa",costCenterId:"",status:"Active",baseSalary:0,mobilization:0,collation:0,gratificationType:"Automatico",gratification:0,bonosFijos:[],healthSystem:void 0,healthContributionType:"Porcentaje",healthContributionValue:7,afp:void 0,unemploymentInsuranceType:void 0,hasUnemploymentInsurance:!0,hasFamilyAllowance:!1,familyDependents:0,familyAllowanceBracket:void 0,apvInstitution:"",apvAmount:0,apvRegime:void 0,paymentMethod:void 0,bank:void 0,accountType:void 0,accountNumber:""};function k({companyId:e,employeeId:n,employeeName:s}){let o=(0,x.useRouter)(),{toast:r}=(0,I.useToast)(),[c,d]=l.default.useState(!1),[u,h]=l.default.useState(!1),[m,g]=l.default.useState(null),[C,v]=l.default.useState(!1),b=async()=>{h(!0),g((await N(e,n)).hasHistory),h(!1),v(!0)},S=async()=>{d(!0);let a=await f(e,n);a.success?(r({title:"Éxito",description:a.message}),o.push("/dashboard/employees")):r({title:"Error",description:a.message,variant:"destructive"}),d(!1),v(!1)},y=async()=>{d(!0);let a=await L(e,n);a.success?(r({title:"Éxito",description:a.message}),o.push("/dashboard/employees")):r({title:"Error",description:a.message,variant:"destructive"}),d(!1),v(!1)};return(0,a.jsxs)(i.AlertDialog,{open:C,onOpenChange:v,children:[(0,a.jsxs)(t.Button,{variant:"destructive",onClick:b,disabled:u,children:[u?(0,a.jsx)(j.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(p.Trash2,{className:"mr-2 h-4 w-4"}),u?"Verificando...":"Eliminar"]}),null!==m&&(m?(0,a.jsxs)(i.AlertDialogContent,{children:[(0,a.jsxs)(i.AlertDialogHeader,{children:[(0,a.jsxs)(i.AlertDialogTitle,{children:["¿Desactivar a ",s,"?"]}),(0,a.jsx)(i.AlertDialogDescription,{children:"Este empleado tiene historial y solo puede ser desactivado."})]}),(0,a.jsxs)(i.AlertDialogFooter,{children:[(0,a.jsx)(i.AlertDialogCancel,{children:"Cancelar"}),(0,a.jsx)(i.AlertDialogAction,{onClick:S,disabled:c,children:"Desactivar"})]})]}):(0,a.jsxs)(i.AlertDialogContent,{children:[(0,a.jsxs)(i.AlertDialogHeader,{children:[(0,a.jsxs)(i.AlertDialogTitle,{children:["¿Eliminar a ",s,"?"]}),(0,a.jsx)(i.AlertDialogDescription,{children:"Puedes desactivarlo (reversible) o eliminarlo permanentemente (irreversible)."})]}),(0,a.jsxs)(i.AlertDialogFooter,{children:[(0,a.jsx)(i.AlertDialogCancel,{children:"Cancelar"}),(0,a.jsx)(t.Button,{variant:"outline",onClick:S,children:"Desactivar"}),(0,a.jsx)(i.AlertDialogAction,{onClick:y,children:"Eliminar"})]})]}))]})}function O(){let e=(0,x.useParams)().id,i="new"===e,{selectedCompany:p}=l.default.useContext(h.SelectedCompanyContext)||{},v=p?.id,b=(0,u.useFirestore)(),y=(0,x.useRouter)(),{toast:N}=(0,I.useToast)(),f=l.default.useMemo(()=>!i&&b&&v?(0,m.doc)(b,`companies/${v}/employees`,e):null,[i,b,v,e]),{data:L,loading:A}=(0,d.useDoc)(f),[D,F]=l.default.useState(q),[V,R]=l.default.useState([]),[O,z]=l.default.useState({isOpen:!1,bono:{glosa:"",monto:0},index:null}),{data:G,loading:Q}=(0,c.useCollection)({path:"afp-entities"}),{data:U,loading:J}=(0,c.useCollection)({path:"health-entities"}),{data:$,loading:W}=(0,c.useCollection)({path:"economic-indicators"}),{data:Y,loading:K}=(0,c.useCollection)({path:v?`companies/${v}/cost-centers`:void 0}),Z=l.default.useMemo(()=>G?[...new Map(G.map(e=>[e.name,e])).values()]:[],[G]),X=l.default.useMemo(()=>U?[...new Map(U.map(e=>[e.name,e])).values()]:[],[U]),_=l.default.useMemo(()=>{if(!$?.length)return 0;let e=$.filter(e=>e.minWage).sort((e,a)=>a.id.localeCompare(e.id))[0];return e?.minWage?Math.round(4.75*e.minWage/12):0},[$]);l.default.useEffect(()=>{if(!D)return;let e=0;"Automatico"===D.gratificationType&&D.baseSalary&&_>0?e=Math.round(Math.min(.25*D.baseSalary,_)):"Tope Legal"===D.gratificationType&&(e=_),D.gratification!==e&&ea("gratification",e)},[D?.baseSalary,D?.gratificationType,_]);let ee=e=>e?new Date(e.toDate?e.toDate():e).toISOString().split("T")[0]:"";l.default.useEffect(()=>{if(i)F({...q,companyId:v});else if(L){let e={...q,...L};e.birthDate=ee(e.birthDate),e.contractStartDate=ee(e.contractStartDate),e.contractEndDate=ee(e.contractEndDate),e.region&&R(S[e.region]||[]),F(e)}},[i,L,v]);let ea=(e,a)=>{F(l=>{let n={...l,[e]:a};return"region"===e&&(n.commune="",R(S[a]||[])),n})},el=A||W||Q||J||K;return el?(0,a.jsx)("p",{children:"Cargando..."}):D?(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(t.Button,{variant:"outline",size:"icon",asChild:!0,children:(0,a.jsx)(C.default,{href:"/dashboard/employees",children:(0,a.jsx)(g.ArrowLeft,{className:"h-4 w-4"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(n.CardTitle,{children:i?"Agregar Nuevo Empleado":`Editar Ficha de ${D.firstName} ${D.lastName}`}),(0,a.jsx)(n.CardDescription,{children:"Completa todos los campos de la ficha del empleado."})]})]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-8 pt-6",children:[(0,a.jsx)(P,{employee:D,handleFieldChange:ea,availableCommunes:V}),(0,a.jsx)(T,{employee:D,handleFieldChange:ea,costCenters:Y}),(0,a.jsx)(M,{employee:D,handleFieldChange:ea,setBonoDialogState:z}),(0,a.jsx)(E,{employee:D,handleFieldChange:ea}),(0,a.jsx)(B,{employee:D,handleFieldChange:ea,uniqueAfpEntities:Z,uniqueHealthEntities:X}),(0,a.jsx)(w,{employee:D,handleFieldChange:ea}),(0,a.jsx)(H,{employee:D,handleFieldChange:ea})]}),(0,a.jsxs)(n.CardFooter,{className:"flex justify-between",children:[!i&&(0,a.jsx)(k,{companyId:v,employeeId:e,employeeName:`${D.firstName} ${D.lastName}`}),(0,a.jsx)(t.Button,{onClick:()=>{if(!b||!v||!D)return;let a=e=>e?m.Timestamp.fromDate(new Date(e)):null,{gratification:l,...n}={...D};n.rut&&(n.rut=n.rut.replace(/\./g,""));let s={...Object.entries(n).reduce((e,[a,l])=>({...e,[a]:void 0===l?null:l}),{}),companyId:v};s.birthDate=a(s.birthDate),s.contractStartDate=a(s.contractStartDate),s.contractEndDate=a(s.contractEndDate);let t=i?(0,m.doc)((0,m.collection)(b,`companies/${v}/employees`)):(0,m.doc)(b,`companies/${v}/employees`,e);(i?(0,m.setDoc)(t,s):(0,m.updateDoc)(t,s)).then(()=>{N({title:"Éxito",description:"Ficha de personal guardada."}),y.push("/dashboard/employees")}).catch(e=>{console.error("Firestore Error:",e),N({title:"Error",description:e.message,variant:"destructive"})})},disabled:el,children:el?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Guardando..."]}):"Guardar Cambios"})]}),(0,a.jsx)(s.Dialog,{open:O.isOpen,onOpenChange:e=>z(a=>({...a,isOpen:e})),children:(0,a.jsxs)(s.DialogContent,{children:[(0,a.jsxs)(s.DialogHeader,{children:[(0,a.jsx)(s.DialogTitle,{children:null===O.index?"Agregar Bono Fijo":"Editar Bono Fijo"}),(0,a.jsx)(s.DialogDescription,{children:"Ingrese los datos del bono fijo."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Glosa"}),(0,a.jsx)(o.Input,{value:O.bono.glosa,onChange:e=>z(a=>({...a,bono:{...a.bono,glosa:e.target.value}}))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"Monto"}),(0,a.jsx)(o.Input,{type:"number",value:O.bono.monto,onChange:e=>z(a=>({...a,bono:{...a.bono,monto:parseFloat(e.target.value)||0}}))})]})]}),(0,a.jsxs)(s.DialogFooter,{children:[(0,a.jsx)(t.Button,{type:"button",variant:"secondary",onClick:()=>z({isOpen:!1,bono:{glosa:"",monto:0},index:null}),children:"Cancelar"}),(0,a.jsx)(t.Button,{type:"button",onClick:()=>{if(!O.bono.glosa||!O.bono.monto)return;let e=D.bonosFijos||[];ea("bonosFijos",null!==O.index?e.map((e,a)=>a===O.index?O.bono:e):[...e,O.bono]),z({isOpen:!1,bono:{glosa:"",monto:0},index:null})},children:"Guardar"})]})]})})]}):null}e.s(["default",()=>O],6555)}]);
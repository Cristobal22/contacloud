(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(75157);let o=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("div",{ref:o,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));o.displayName="Card";let s=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("div",{ref:o,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...r}));s.displayName="CardHeader";let l=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("div",{ref:o,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let n=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("div",{ref:o,className:(0,a.cn)("text-sm text-muted-foreground",e),...r}));n.displayName="CardDescription";let i=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("div",{ref:o,className:(0,a.cn)("p-6 pt-0",e),...r}));i.displayName="CardContent";let d=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("div",{ref:o,className:(0,a.cn)("flex items-center p-6 pt-0",e),...r}));d.displayName="CardFooter",e.s(["Card",()=>o,"CardContent",()=>i,"CardDescription",()=>n,"CardFooter",()=>d,"CardHeader",()=>s,"CardTitle",()=>l])},84774,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(75157);let o=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:o,className:(0,a.cn)("w-full caption-bottom text-sm",e),...r})}));o.displayName="Table";let s=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("thead",{ref:o,className:(0,a.cn)("[&_tr]:border-b",e),...r}));s.displayName="TableHeader";let l=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("tbody",{ref:o,className:(0,a.cn)("[&_tr:last-child]:border-0",e),...r}));l.displayName="TableBody";let n=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("tfoot",{ref:o,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...r}));n.displayName="TableFooter";let i=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("tr",{ref:o,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...r}));i.displayName="TableRow";let d=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("th",{ref:o,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...r}));d.displayName="TableHead";let c=r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("td",{ref:o,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...r}));c.displayName="TableCell",r.forwardRef(({className:e,...r},o)=>(0,t.jsx)("caption",{ref:o,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",e),...r})).displayName="TableCaption",e.s(["Table",()=>o,"TableBody",()=>l,"TableCell",()=>c,"TableFooter",()=>n,"TableHead",()=>d,"TableHeader",()=>s,"TableRow",()=>i])},97245,e=>{"use strict";var t=e.i(35684),r=e.i(96226);function a(e,a){let o=(0,t.toDate)(e);if(isNaN(a))return(0,r.constructFrom)(e,NaN);if(!a)return o;let s=o.getDate(),l=(0,r.constructFrom)(e,o.getTime());return(l.setMonth(o.getMonth()+a+1,0),s>=l.getDate())?l:(o.setFullYear(l.getFullYear(),l.getMonth(),s),o)}e.s(["addMonths",()=>a])},39189,e=>{"use strict";var t=e.i(35684),r=e.i(96226);function a(e,a){let o=(0,t.toDate)(e);return isNaN(a)?(0,r.constructFrom)(e,NaN):(a&&o.setDate(o.getDate()+a),o)}e.s(["addDays",()=>a])},37822,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(81140),o=e.i(20783),s=e.i(30030),l=e.i(26330),n=e.i(3536),i=e.i(65491),d=e.i(10772),c=e.i(53660),u=e.i(74606),p=e.i(96626),f=e.i(48425),m=e.i(91918),x=e.i(69340),h=e.i(86312),g=e.i(85369),v="Popover",[j,C]=(0,s.createContextScope)(v,[c.createPopperScope]),b=(0,c.createPopperScope)(),[N,w]=j(v),y=e=>{let{__scopePopover:a,children:o,open:s,defaultOpen:l,onOpenChange:n,modal:i=!1}=e,u=b(a),p=r.useRef(null),[f,m]=r.useState(!1),[h,g]=(0,x.useControllableState)({prop:s,defaultProp:l??!1,onChange:n,caller:v});return(0,t.jsx)(c.Root,{...u,children:(0,t.jsx)(N,{scope:a,contentId:(0,d.useId)(),triggerRef:p,open:h,onOpenChange:g,onOpenToggle:r.useCallback(()=>g(e=>!e),[g]),hasCustomAnchor:f,onCustomAnchorAdd:r.useCallback(()=>m(!0),[]),onCustomAnchorRemove:r.useCallback(()=>m(!1),[]),modal:i,children:o})})};y.displayName=v;var T="PopoverAnchor";r.forwardRef((e,a)=>{let{__scopePopover:o,...s}=e,l=w(T,o),n=b(o),{onCustomAnchorAdd:i,onCustomAnchorRemove:d}=l;return r.useEffect(()=>(i(),()=>d()),[i,d]),(0,t.jsx)(c.Anchor,{...n,...s,ref:a})}).displayName=T;var R="PopoverTrigger",P=r.forwardRef((e,r)=>{let{__scopePopover:s,...l}=e,n=w(R,s),i=b(s),d=(0,o.useComposedRefs)(r,n.triggerRef),u=(0,t.jsx)(f.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":$(n.open),...l,ref:d,onClick:(0,a.composeEventHandlers)(e.onClick,n.onOpenToggle)});return n.hasCustomAnchor?u:(0,t.jsx)(c.Anchor,{asChild:!0,...i,children:u})});P.displayName=R;var D="PopoverPortal",[F,S]=j(D,{forceMount:void 0}),k=e=>{let{__scopePopover:r,forceMount:a,children:o,container:s}=e,l=w(D,r);return(0,t.jsx)(F,{scope:r,forceMount:a,children:(0,t.jsx)(p.Presence,{present:a||l.open,children:(0,t.jsx)(u.Portal,{asChild:!0,container:s,children:o})})})};k.displayName=D;var L="PopoverContent",M=r.forwardRef((e,r)=>{let a=S(L,e.__scopePopover),{forceMount:o=a.forceMount,...s}=e,l=w(L,e.__scopePopover);return(0,t.jsx)(p.Presence,{present:o||l.open,children:l.modal?(0,t.jsx)(H,{...s,ref:r}):(0,t.jsx)(O,{...s,ref:r})})});M.displayName=L;var A=(0,m.createSlot)("PopoverContent.RemoveScroll"),H=r.forwardRef((e,s)=>{let l=w(L,e.__scopePopover),n=r.useRef(null),i=(0,o.useComposedRefs)(s,n),d=r.useRef(!1);return r.useEffect(()=>{let e=n.current;if(e)return(0,h.hideOthers)(e)},[]),(0,t.jsx)(g.RemoveScroll,{as:A,allowPinchZoom:!0,children:(0,t.jsx)(E,{...e,ref:i,trapFocus:l.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,a.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),d.current||l.triggerRef.current?.focus()}),onPointerDownOutside:(0,a.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;d.current=2===t.button||r},{checkForDefaultPrevented:!1}),onFocusOutside:(0,a.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),O=r.forwardRef((e,a)=>{let o=w(L,e.__scopePopover),s=r.useRef(!1),l=r.useRef(!1);return(0,t.jsx)(E,{...e,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(s.current||o.triggerRef.current?.focus(),t.preventDefault()),s.current=!1,l.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(l.current=!0));let r=t.target;o.triggerRef.current?.contains(r)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&l.current&&t.preventDefault()}})}),E=r.forwardRef((e,r)=>{let{__scopePopover:a,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:d,disableOutsidePointerEvents:u,onEscapeKeyDown:p,onPointerDownOutside:f,onFocusOutside:m,onInteractOutside:x,...h}=e,g=w(L,a),v=b(a);return(0,n.useFocusGuards)(),(0,t.jsx)(i.FocusScope,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:s,onUnmountAutoFocus:d,children:(0,t.jsx)(l.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:u,onInteractOutside:x,onEscapeKeyDown:p,onPointerDownOutside:f,onFocusOutside:m,onDismiss:()=>g.onOpenChange(!1),children:(0,t.jsx)(c.Content,{"data-state":$(g.open),role:"dialog",id:g.contentId,...v,...h,ref:r,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),I="PopoverClose";function $(e){return e?"open":"closed"}r.forwardRef((e,r)=>{let{__scopePopover:o,...s}=e,l=w(I,o);return(0,t.jsx)(f.Primitive.button,{type:"button",...s,ref:r,onClick:(0,a.composeEventHandlers)(e.onClick,()=>l.onOpenChange(!1))})}).displayName=I,r.forwardRef((e,r)=>{let{__scopePopover:a,...o}=e,s=b(a);return(0,t.jsx)(c.Arrow,{...s,...o,ref:r})}).displayName="PopoverArrow";var _=e.i(75157);let B=r.forwardRef(({className:e,align:r="center",sideOffset:a=4,...o},s)=>(0,t.jsx)(k,{children:(0,t.jsx)(M,{ref:s,align:r,sideOffset:a,className:(0,_.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...o})}));B.displayName=M.displayName,e.s(["Popover",()=>y,"PopoverContent",()=>B,"PopoverTrigger",()=>P],37822)},38815,e=>{"use strict";var t=e.i(35684);function r(e,r){return+(0,t.toDate)(e)<+(0,t.toDate)(r)}e.s(["isBefore",()=>r])},88515,e=>{"use strict";var t=e.i(35684);function r(e){let r=(0,t.toDate)(e),a=r.getMonth();return r.setFullYear(r.getFullYear(),a+1,0),r.setHours(0,0,0,0),r}e.s(["lastDayOfMonth",()=>r])},16340,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(45919),o=e.i(43104),s=e.i(87316),l=e.i(75157),n=e.i(19455),i=e.i(27766),d=e.i(37822);function c({className:e,date:c,onDateChange:u}){let[p,f]=r.useState(c);return r.useEffect(()=>{f(c)},[c]),(0,t.jsx)("div",{className:(0,l.cn)("grid gap-2",e),children:(0,t.jsxs)(d.Popover,{children:[(0,t.jsx)(d.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(n.Button,{id:"date",variant:"outline",className:(0,l.cn)("w-full justify-start text-left font-normal",!p&&"text-muted-foreground"),children:[(0,t.jsx)(s.Calendar,{className:"mr-2 h-4 w-4"}),p?.from?p.to?(0,t.jsxs)(t.Fragment,{children:[(0,a.format)(p.from,"LLL dd, y",{locale:o.es})," -"," ",(0,a.format)(p.to,"LLL dd, y",{locale:o.es})]}):(0,a.format)(p.from,"LLL dd, y",{locale:o.es}):(0,t.jsx)("span",{children:"Selecciona un rango de fechas"})]})}),(0,t.jsx)(d.PopoverContent,{className:"w-auto p-0",align:"start",children:(0,t.jsx)(i.Calendar,{initialFocus:!0,mode:"range",defaultMonth:p?.from,selected:p,onSelect:e=>{f(e),u&&u(e)},numberOfMonths:2,locale:o.es})})]})})}e.s(["DateRangePicker",()=>c])},22578,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(15288),o=e.i(19455),s=e.i(16340),l=e.i(84774),n=e.i(45919),i=e.i(43104);e.i(11981);var d=e.i(80428),c=e.i(61480),u=e.i(39126);e.i(36180);var p=e.i(17875),f=e.i(75254);let m=(0,f.default)("CircleArrowDown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]),x=(0,f.default)("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);function h(){let{selectedCompany:e}=r.default.useContext(u.SelectedCompanyContext)||{},f=e?.id,h=(0,c.useFirestore)(),[g,v]=r.default.useState({from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date(new Date().getFullYear(),new Date().getMonth()+1,0)}),[j,C]=r.default.useState(null),b=r.default.useMemo(()=>h&&f?(0,p.query)((0,p.collection)(h,`companies/${f}/vouchers`),(0,p.where)("status","==","Contabilizado"),(0,p.where)("type","in",["Ingreso","Egreso"])):null,[h,f]),{data:N,loading:w}=(0,d.useCollection)({query:b,disabled:!b});return(0,t.jsxs)("div",{className:"grid gap-6",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Informe de Flujo de Caja"}),(0,t.jsx)(a.CardDescription,{children:"Selecciona un período para analizar los ingresos y egresos de efectivo."})]}),(0,t.jsx)(a.CardContent,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-end max-w-lg",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(s.DateRangePicker,{date:g,onDateChange:v})}),(0,t.jsx)(o.Button,{onClick:()=>{if(!N||!g?.from||!g?.to)return void C(null);let e=g.from,t=g.to,r=N.filter(r=>{let a=new Date(r.date);return a>=e&&a<=t}).map(e=>({id:e.id,date:e.date,description:e.description,type:e.type,total:e.total})).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),a=r.filter(e=>"Ingreso"===e.type).reduce((e,t)=>e+t.total,0),o=r.filter(e=>"Egreso"===e.type).reduce((e,t)=>e+t.total,0);C({entries:r,totals:{income:a,outcome:o,net:a-o}})},disabled:w||!f,children:w?"Cargando...":"Generar Informe"})]})})]}),j&&(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Flujo de Caja del Período"}),(0,t.jsx)(a.CardDescription,{children:g?.from&&g.to?`Resultados para el per\xedodo del ${(0,n.format)(g.from,"P",{locale:i.es})} al ${(0,n.format)(g.to,"P",{locale:i.es})}.`:""})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsxs)(l.Table,{children:[(0,t.jsx)(l.TableHeader,{children:(0,t.jsxs)(l.TableRow,{children:[(0,t.jsx)(l.TableHead,{children:"Fecha"}),(0,t.jsx)(l.TableHead,{children:"Descripción"}),(0,t.jsx)(l.TableHead,{className:"text-right",children:"Ingresos"}),(0,t.jsx)(l.TableHead,{className:"text-right",children:"Egresos"})]})}),(0,t.jsxs)(l.TableBody,{children:[0===j.entries.length&&(0,t.jsx)(l.TableRow,{children:(0,t.jsx)(l.TableCell,{colSpan:4,className:"text-center",children:"No hay movimientos de caja en el período seleccionado."})}),j.entries.map(e=>(0,t.jsxs)(l.TableRow,{children:[(0,t.jsx)(l.TableCell,{children:new Date(e.date).toLocaleDateString("es-CL",{timeZone:"UTC"})}),(0,t.jsxs)(l.TableCell,{className:"flex items-center gap-2",children:["Ingreso"===e.type?(0,t.jsx)(x,{className:"h-4 w-4 text-green-500"}):(0,t.jsx)(m,{className:"h-4 w-4 text-red-500"}),e.description]}),(0,t.jsx)(l.TableCell,{className:"text-right text-green-600 font-medium",children:"Ingreso"===e.type?`$${Math.round(e.total).toLocaleString("es-CL")}`:""}),(0,t.jsx)(l.TableCell,{className:"text-right text-red-600 font-medium",children:"Egreso"===e.type?`$${Math.round(e.total).toLocaleString("es-CL")}`:""})]},e.id))]}),(0,t.jsx)(l.TableFooter,{children:(0,t.jsxs)(l.TableRow,{className:"text-base",children:[(0,t.jsx)(l.TableCell,{colSpan:2,className:"font-bold",children:"Totales"}),(0,t.jsxs)(l.TableCell,{className:"text-right font-bold text-green-600",children:["$",Math.round(j.totals.income).toLocaleString("es-CL")]}),(0,t.jsxs)(l.TableCell,{className:"text-right font-bold text-red-600",children:["$",Math.round(j.totals.outcome).toLocaleString("es-CL")]})]})})]})}),(0,t.jsx)(a.CardFooter,{className:"flex justify-end pt-4",children:(0,t.jsxs)("div",{className:"text-right p-4 rounded-lg bg-muted",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Flujo de Caja Neto del Período"}),(0,t.jsxs)("p",{className:`text-2xl font-bold ${j.totals.net>=0?"text-green-600":"text-red-600"}`,children:["$",Math.round(j.totals.net).toLocaleString("es-CL")]})]})})]})]})}e.s(["default",()=>h],22578)}]);
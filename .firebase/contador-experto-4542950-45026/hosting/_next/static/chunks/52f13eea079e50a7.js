(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var a=e.i(43476),r=e.i(71645),t=e.i(75157);let s=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));s.displayName="Card";let o=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("flex flex-col space-y-1.5 p-6",e),...r}));o.displayName="CardHeader";let l=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let i=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("text-sm text-muted-foreground",e),...r}));i.displayName="CardDescription";let d=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("p-6 pt-0",e),...r}));d.displayName="CardContent";let n=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("flex items-center p-6 pt-0",e),...r}));n.displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>d,"CardDescription",()=>i,"CardFooter",()=>n,"CardHeader",()=>o,"CardTitle",()=>l])},68499,e=>{"use strict";var a=e.i(43476),r=e.i(71645),t=e.i(30030),s=e.i(20783),o=e.i(26999),l=e.i(81140),i=e.i(91918),d="AlertDialog",[n,c]=(0,t.createContextScope)(d,[o.createDialogScope]),p=(0,o.createDialogScope)(),f=e=>{let{__scopeAlertDialog:r,...t}=e,s=p(r);return(0,a.jsx)(o.Root,{...s,...t,modal:!0})};f.displayName=d;var m=r.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...s}=e,l=p(t);return(0,a.jsx)(o.Trigger,{...l,...s,ref:r})});m.displayName="AlertDialogTrigger";var u=e=>{let{__scopeAlertDialog:r,...t}=e,s=p(r);return(0,a.jsx)(o.Portal,{...s,...t})};u.displayName="AlertDialogPortal";var x=r.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...s}=e,l=p(t);return(0,a.jsx)(o.Overlay,{...l,...s,ref:r})});x.displayName="AlertDialogOverlay";var g="AlertDialogContent",[h,j]=n(g),y=(0,i.createSlottable)("AlertDialogContent"),N=r.forwardRef((e,t)=>{let{__scopeAlertDialog:i,children:d,...n}=e,c=p(i),f=r.useRef(null),m=(0,s.useComposedRefs)(t,f),u=r.useRef(null);return(0,a.jsx)(o.WarningProvider,{contentName:g,titleName:v,docsSlug:"alert-dialog",children:(0,a.jsx)(h,{scope:i,cancelRef:u,children:(0,a.jsxs)(o.Content,{role:"alertdialog",...c,...n,ref:m,onOpenAutoFocus:(0,l.composeEventHandlers)(n.onOpenAutoFocus,e=>{e.preventDefault(),u.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(y,{children:d}),(0,a.jsx)(S,{contentRef:f})]})})})});N.displayName=g;var v="AlertDialogTitle",D=r.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...s}=e,l=p(t);return(0,a.jsx)(o.Title,{...l,...s,ref:r})});D.displayName=v;var C="AlertDialogDescription",b=r.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...s}=e,l=p(t);return(0,a.jsx)(o.Description,{...l,...s,ref:r})});b.displayName=C;var A=r.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...s}=e,l=p(t);return(0,a.jsx)(o.Close,{...l,...s,ref:r})});A.displayName="AlertDialogAction";var w="AlertDialogCancel",R=r.forwardRef((e,r)=>{let{__scopeAlertDialog:t,...l}=e,{cancelRef:i}=j(w,t),d=p(t),n=(0,s.useComposedRefs)(r,i);return(0,a.jsx)(o.Close,{...d,...l,ref:n})});R.displayName=w;var S=({contentRef:e})=>{let a=`\`${g}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${g}\` by passing a \`${C}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${g}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return r.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(a)},[a,e]),null},P=e.i(75157),T=e.i(19455);let O=r.forwardRef(({className:e,...r},t)=>(0,a.jsx)(x,{className:(0,P.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r,ref:t}));O.displayName=x.displayName;let E=r.forwardRef(({className:e,...r},t)=>(0,a.jsxs)(u,{children:[(0,a.jsx)(O,{}),(0,a.jsx)(N,{ref:t,className:(0,P.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r})]}));E.displayName=N.displayName;let F=({className:e,...r})=>(0,a.jsx)("div",{className:(0,P.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...r});F.displayName="AlertDialogHeader";let z=({className:e,...r})=>(0,a.jsx)("div",{className:(0,P.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r});z.displayName="AlertDialogFooter";let I=r.forwardRef(({className:e,...r},t)=>(0,a.jsx)(D,{ref:t,className:(0,P.cn)("text-lg font-semibold",e),...r}));I.displayName=D.displayName;let q=r.forwardRef(({className:e,...r},t)=>(0,a.jsx)(b,{ref:t,className:(0,P.cn)("text-sm text-muted-foreground",e),...r}));q.displayName=b.displayName;let H=r.forwardRef(({className:e,...r},t)=>(0,a.jsx)(A,{ref:t,className:(0,P.cn)((0,T.buttonVariants)(),e),...r}));H.displayName=A.displayName;let $=r.forwardRef(({className:e,...r},t)=>(0,a.jsx)(R,{ref:t,className:(0,P.cn)((0,T.buttonVariants)({variant:"outline"}),"mt-2 sm:mt-0",e),...r}));$.displayName=R.displayName,e.s(["AlertDialog",()=>f,"AlertDialogAction",()=>H,"AlertDialogCancel",()=>$,"AlertDialogContent",()=>E,"AlertDialogDescription",()=>q,"AlertDialogFooter",()=>z,"AlertDialogHeader",()=>F,"AlertDialogTitle",()=>I,"AlertDialogTrigger",()=>m],68499)},2722,e=>{"use strict";var a=e.i(43476),r=e.i(15288),t=e.i(19455),s=e.i(70756),o=e.i(71645),l=e.i(68499),i=e.i(39126);e.i(11981);var d=e.i(61480);e.i(36180);var n=e.i(17875),c=e.i(8406),p=e.i(57094),f=e.i(50350),m=e.i(45919),u=e.i(86135),x=e.i(43104);function g(){let{selectedCompany:e}=o.default.useContext(i.SelectedCompanyContext)||{},g=e?.id,h=(0,d.useFirestore)(),{toast:j}=(0,c.useToast)(),[y,N]=o.default.useState(!1),v=e?.periodEndDate,D=!!e,C=async()=>{if(!h||!g||!v)return void j({variant:"destructive",title:"Error",description:"No se puede cerrar el período porque no hay una fecha de finalización definida para el período de trabajo actual de la empresa."});N(!0);let e=(0,n.doc)(h,"companies",g);try{await (0,n.updateDoc)(e,{lastClosedDate:v}),j({title:"Período Cerrado Exitosamente",description:`Se ha bloqueado el per\xedodo hasta el ${(0,m.format)((0,u.parseISO)(v),"P",{locale:x.es})}.`})}catch(a){console.error("Error closing period:",a),p.errorEmitter.emit("permission-error",new f.FirestorePermissionError({path:e.path,operation:"update",requestResourceData:{lastClosedDate:v}}))}finally{N(!1)}};v&&(0,m.format)((0,u.parseISO)(v),"MMMM 'de' yyyy",{locale:x.es});let b=e?.lastClosedDate?(0,m.format)((0,u.parseISO)(e.lastClosedDate),"P",{locale:x.es}):"Ninguno";return(0,a.jsxs)(r.Card,{children:[(0,a.jsxs)(r.CardHeader,{children:[(0,a.jsx)(r.CardTitle,{children:"Cierre Mensual"}),(0,a.jsx)(r.CardDescription,{children:"Realiza el proceso de cierre contable mensual para bloquear el período."})]}),(0,a.jsx)(r.CardContent,{children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 rounded-xl border border-dashed p-8 text-center",children:[(0,a.jsx)(s.Lock,{className:"h-12 w-12 text-destructive"}),(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:["Proceso de Cierre para ",(0,a.jsx)("span",{className:"text-primary",children:e?.name||"..."})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,a.jsxs)("p",{children:["Período de trabajo actual finaliza el: ",(0,a.jsx)("span",{className:"font-bold",children:v?(0,m.format)((0,u.parseISO)(v),"P",{locale:x.es}):"No definido"}),"."]}),(0,a.jsxs)("p",{children:["Último cierre realizado el: ",(0,a.jsx)("span",{className:"font-bold",children:b}),"."]})]}),(0,a.jsx)("p",{className:"max-w-md text-sm",children:v?`Al ejecutar el cierre, se actualizar\xe1 la fecha del \xfaltimo cierre al ${(0,m.format)((0,u.parseISO)(v),"P",{locale:x.es})}. No se podr\xe1n crear ni modificar comprobantes con fecha anterior o igual a esta.`:"Define un período de trabajo en la configuración de la empresa para poder ejecutar el cierre."}),(0,a.jsxs)(l.AlertDialog,{children:[(0,a.jsx)(l.AlertDialogTrigger,{asChild:!0,children:(0,a.jsx)(t.Button,{variant:"destructive",disabled:!D||y,children:y?"Procesando...":"Ejecutar Cierre"})}),(0,a.jsxs)(l.AlertDialogContent,{children:[(0,a.jsxs)(l.AlertDialogHeader,{children:[(0,a.jsx)(l.AlertDialogTitle,{children:"¿Estás absolutamente seguro?"}),(0,a.jsx)(l.AlertDialogDescription,{children:v?`Esta acci\xf3n es irreversible. Al ejecutar el cierre mensual, se bloquear\xe1n todos los movimientos hasta el ${(0,m.format)((0,u.parseISO)(v),"P",{locale:x.es})}. Aseg\xfarate de haber revisado toda la informaci\xf3n antes de proceder.`:"No se puede continuar porque no hay una fecha de fin de período definida."})]}),(0,a.jsxs)(l.AlertDialogFooter,{children:[(0,a.jsx)(l.AlertDialogCancel,{children:"Cancelar"}),(0,a.jsx)(l.AlertDialogAction,{className:(0,t.buttonVariants)({variant:"destructive"}),onClick:C,disabled:!v||y,children:"Sí, ejecutar cierre"})]})]})]})]})})]})}e.s(["default",()=>g])}]);
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var a=e.i(43476),l=e.i(71645),r=e.i(75157);let t=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...l}));t.displayName="Card";let d=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...l}));d.displayName="CardHeader";let s=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",e),...l}));s.displayName="CardTitle";let i=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",e),...l}));i.displayName="CardDescription";let o=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",e),...l}));o.displayName="CardContent";let n=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",e),...l}));n.displayName="CardFooter",e.s(["Card",()=>t,"CardContent",()=>o,"CardDescription",()=>i,"CardFooter",()=>n,"CardHeader",()=>d,"CardTitle",()=>s])},84774,e=>{"use strict";var a=e.i(43476),l=e.i(71645),r=e.i(75157);let t=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",e),...l})}));t.displayName="Table";let d=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",e),...l}));d.displayName="TableHeader";let s=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",e),...l}));s.displayName="TableBody";let i=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...l}));i.displayName="TableFooter";let o=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...l}));o.displayName="TableRow";let n=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...l}));n.displayName="TableHead";let c=l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...l}));c.displayName="TableCell",l.forwardRef(({className:e,...l},t)=>(0,a.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",e),...l})).displayName="TableCaption",e.s(["Table",()=>t,"TableBody",()=>s,"TableCell",()=>c,"TableFooter",()=>i,"TableHead",()=>n,"TableHeader",()=>d,"TableRow",()=>o])},12271,e=>{"use strict";var a=e.i(43476),l=e.i(71645),r=e.i(84774),t=e.i(15288);e.i(11981);var d=e.i(80428),s=e.i(61480),i=e.i(39126);e.i(36180);var o=e.i(17875);function n(){let{selectedCompany:e}=l.default.useContext(i.SelectedCompanyContext)||{},n=e?.id,c=(0,s.useFirestore)(),{data:f,loading:m}=(0,d.useCollection)({path:n?`companies/${n}/accounts`:void 0,companyId:n}),b=l.default.useMemo(()=>c&&n?(0,o.query)((0,o.collection)(c,`companies/${n}/vouchers`),(0,o.where)("status","==","Contabilizado")):null,[c,n]),{data:u,loading:x}=(0,d.useCollection)({query:b,disabled:!b}),h=l.default.useMemo(()=>{if(!f)return[];let e=new Map;f.forEach(a=>{e.set(a.code,{initialBalance:a.balance||0,debit:0,credit:0,finalBalance:a.balance||0})}),u?.forEach(a=>{a.entries.forEach(a=>{if(e.has(a.account)){let l=e.get(a.account);l.debit+=Number(a.debit)||0,l.credit+=Number(a.credit)||0}})}),e.forEach((e,a)=>{let l=f.find(e=>e.code===a);l?.type==="Activo"||l?.type==="Resultado"?e.finalBalance=e.initialBalance+e.debit-e.credit:e.finalBalance=e.initialBalance+e.credit-e.debit});let a=Array.from(e.keys()).sort((e,a)=>e.localeCompare(a,void 0,{numeric:!0}));for(let l=a.length-1;l>=0;l--){let r=a[l],t="";r.length>1&&(r.length>5?t=r.substring(0,5):5===r.length?t=r.substring(0,3):3===r.length&&(t=r.substring(0,1))),t&&e.has(t)&&(e.get(t).finalBalance+=e.get(r).finalBalance)}return a.map(a=>{let l=f.find(e=>e.code===a),r=e.get(a);return{...l,finalBalance:r.finalBalance}}).filter(e=>0!==e.finalBalance)},[f,u]),p=m||x;return(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{children:[(0,a.jsx)(t.CardTitle,{children:"Libro Mayor"}),(0,a.jsx)(t.CardDescription,{children:"Consulta los saldos de las cuentas en el libro mayor. Solo se consideran comprobantes contabilizados."})]}),(0,a.jsx)(t.CardContent,{children:(0,a.jsxs)(r.Table,{children:[(0,a.jsx)(r.TableHeader,{children:(0,a.jsxs)(r.TableRow,{children:[(0,a.jsx)(r.TableHead,{children:"CÃ³digo"}),(0,a.jsx)(r.TableHead,{children:"Nombre de Cuenta"}),(0,a.jsx)(r.TableHead,{children:"Tipo"}),(0,a.jsx)(r.TableHead,{className:"text-right",children:"Saldo Final"})]})}),(0,a.jsxs)(r.TableBody,{children:[p&&(0,a.jsx)(r.TableRow,{children:(0,a.jsx)(r.TableCell,{colSpan:4,className:"text-center",children:"Cargando..."})}),!p&&h.map(e=>(0,a.jsxs)(r.TableRow,{children:[(0,a.jsx)(r.TableCell,{className:"font-medium",children:e.code}),(0,a.jsx)(r.TableCell,{children:e.name}),(0,a.jsx)(r.TableCell,{children:e.type}),(0,a.jsxs)(r.TableCell,{className:"text-right font-medium",children:["$",Math.round(e.finalBalance).toLocaleString("es-CL")]})]},e.id)),!p&&0===h.length&&(0,a.jsx)(r.TableRow,{children:(0,a.jsx)(r.TableCell,{colSpan:4,className:"text-center",children:n?"No hay cuentas con saldo para mostrar en el libro mayor.":"Selecciona una empresa para ver el libro mayor."})})]})]})})]})}e.s(["default",()=>n])}]);